﻿﻿﻿﻿﻿﻿@{ ViewBag.Title = "Trang Chủ | OPCPHARMA";
    @model System.Data.DataSet
    string username;
    username = Request.Cookies["UserName"].Value;
    int rowCount = 0;
    string dvcs = Request.Cookies["MA_DVCS"].Value;
    long KhoanNam = 0;
    long KhoanThang = 0;
    string tendv = "";
    switch (Request.Cookies["MA_DVCS"].Value)
    {
        case "": tendv = "Công Ty Cổ Phần Dược Phẩm OPC"; break;
        case "OPC": tendv = "Văn Phòng Trụ Sở"; break;
        case "OPC_CT": tendv = "Chi Nhánh Cần Thơ"; break;
        case "OPC_DN": tendv = "Chi Nhánh Đà Nẵng"; break;
        case "OPC_HN": tendv = "Chi Nhánh Hà Nội"; break;
        case "OPC_MD": tendv = "Chi Nhánh Miền Đông"; break;
        case "OPC_NA": tendv = "Chi Nhánh Nghệ An"; break;
        case "OPC_NT": tendv = "Chi Nhánh Nha Trang"; break;
        case "OPC_TG": tendv = "Chi Nhánh Tiền Giang"; break;
        case "OPC_TP": tendv = "Chi Nhánh Hồ Chí Minh"; break;
        case "OPC_VT": tendv = "Chi Nhánh Vũng Tàu"; break;
    }
    if (Request.Cookies["MA_DVCS"].Value == "OPC_CT")
    {
        KhoanNam = 124001000000;
        KhoanThang = 9921000000;
    }else if (Request.Cookies["MA_DVCS"].Value == "OPC_TG")
    {
        KhoanNam = 63998000000;
        KhoanThang = 5121000000;
    }
    else if (Request.Cookies["MA_DVCS"].Value == "OPC_MD")
    {
        KhoanNam = 85936000000;
        KhoanThang = 6877000000;
    }
    else if (Request.Cookies["MA_DVCS"].Value == "OPC_TP")
    {
        KhoanNam = 81200000000;
        KhoanThang = 6496000000;
    }
    else if (Request.Cookies["MA_DVCS"].Value == "OPC_VT")
    {
        KhoanNam = 30441000000;
        KhoanThang = 2438000000;
    }
    else if (Request.Cookies["MA_DVCS"].Value == "OPC_NT")
    {
        KhoanNam = 51294000000;
        KhoanThang = 4104000000;
    }
    else if (Request.Cookies["MA_DVCS"].Value == "OPC_DN")
    {
        KhoanNam = 48000000000;
        KhoanThang = 3840000000;
    }
    else if (Request.Cookies["MA_DVCS"].Value == "OPC_NA")
    {
        KhoanNam = 30001000000;
        KhoanThang = 2398000000;
    }
    else if (Request.Cookies["MA_DVCS"].Value == "OPC_HN")
    {
        KhoanNam = 48548000000;
        KhoanThang = 3884000000;
    }
    else
    {
        KhoanNam = 888282000000;
        KhoanThang = 71070000000;
    }

}

@using System.Data;
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="~/Styles/Dashboard/responsive.css" rel="stylesheet" type="text/css" media="all" />

    <link href="~/Styles/Dashboard/main-dashboard.css" rel="stylesheet" type="text/css" media="all" />
    <title>DashBoard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" />
    <link href='https://unpkg.com/boxicons@2.0.7/css/boxicons.min.css' rel='stylesheet'>

</head>

<body>


    <nav class="left-sidebar">
        <button type="button" id="toggle-btn">
            <i class="fa fa-bars"></i>
        </button>
        <span class="logo-content">
            <img class="logo-image" src="~/Images/opc.png">
            <span class="logo_name">OPC</span>
        </span>

        <div class="nav-links" id="sidebar">
            <a href="#"><div class="sidebar-title"><i class="fa-solid fa-house"></i> <div>Trang chủ</div></div></a>

            <button class="dropdown-btn" onclick="toggleSubmenu('submenu1', 'arrow1')">
                <div class="sidebar-title">
                    <i class="fa-solid fa-chart-pie"></i>
                    <div>Báo Cáo</div>
                </div>
                <div id="arrow1" class="icon-arrow">
                    <i class="fa-solid fa-chevron-down"></i>
                </div>
            </button>
            <div id="submenu1" class="dropdown-container submenu-container">
                <div style="display:flex">
                    <div class="color1"></div>
                    <button class="submenu-btn" onclick="toggleSubmenu('submenu1_1','arrow-subicon')">
                        1.Báo Cáo Quản Trị
                        <div id="arrow-subicon" class="subicon-arrow">
                            <i class="fa-solid fa-chevron-down"></i>
                        </div>
                    </button>
                </div>
                <div id="submenu1_1" class="submenu-container" style="padding-left:15px">
                    @if (string.Equals(ViewBag.UserName, "admin", StringComparison.OrdinalIgnoreCase) || string.Equals(ViewBag.UserName, "opcadmin", StringComparison.OrdinalIgnoreCase) || string.Equals(ViewBag.UserName, "vpct-nhatanh", StringComparison.OrdinalIgnoreCase))
                    {
                        <a href="#" onclick="runReport('@Url.Action("DoanhThuChiNhanhKGam_Fill", "DoanhThuChiNhanh")'
                                                      )">1.1 Doanh Thu Chi Nhánh</a>
                    }
                    else
                    {
                        <a href="#" onclick="runReport('@Url.Action("DoanhThuChiNhanhKGam_CN_Fill", "DoanhThuChiNhanh")'
                                                      )">1.1 Doanh Thu Chi Nhánh</a>
                    }
                    @if (string.Equals(ViewBag.UserName, "admin", StringComparison.OrdinalIgnoreCase) ||
string.Equals(ViewBag.UserName, "opcmar001", StringComparison.OrdinalIgnoreCase) || string.Equals(ViewBag.UserName, "opcadmin", StringComparison.OrdinalIgnoreCase) || string.Equals(ViewBag.UserName, "vpct-nhatanh", StringComparison.OrdinalIgnoreCase))
                    {
                        <a href="#" onclick="runReport('@Url.Action("DoanhThuChiNhanh_Admin_Fill", "DoanhThuChiNhanh")'
                                                      )">1.2 Doanh Thu CN Theo Gam</a>

                    }
                    else
                    {
                        <a href="#" onclick="runReport('@Url.Action("DoanhThuChiNhanh_Fill", "DoanhThuChiNhanh")'
                                                      )">1.2 Doanh Thu CN Theo Gam</a>

                    }

                    <a href="#" onclick="runReport('@Url.Action("DoanhThuChiNhanhTinhLuong_Fill", "DoanhThuChiNhanh")'
                                                      )">1.3 Doanh Thu CN Tính Lương</a>
                    <a href="#" onclick="runReport('@Url.Action("BaoCaoKetQuaKinhDoanh_Fill", "BaoCaoKetQuaKinhDoanh")'
                                                      )">1.4 Doanh Thu Tổng Hợp - Chi Tiết</a>
                </div>
                <div style="display:flex">
                    <div class="color2"></div>
                    <button class="submenu-btn" onclick="toggleSubmenu('submenu1_2','arrow-subicon_2')">
                        2.Báo Cáo Nghiệp Vụ  <div id="arrow-subicon_2" class="subicon-arrow">
                            <i class="fa-solid fa-chevron-down"></i>
                        </div>
                    </button>
                </div>
                <div id="submenu1_2" class="submenu-container" style="padding-left:15px">
                    @if (string.Equals(ViewBag.UserName, "OPCHCM001", StringComparison.OrdinalIgnoreCase))
                    {


                        <a href="#" onclick="runReport('@Url.Action("bangkehoadon_Fill_HCM", "bangkehoadon")'
                                                      )">2.1 Bảng Kê Chứng Từ SO</a>
                    }
                    else
                    {
                        <a href="#" onclick="runReport('@Url.Action("bangkehoadon_Fill", "bangkehoadon")'
                                                                  )">2.1 Bảng Kê Chứng Từ SO</a>
                    }
                    @if (string.Equals(ViewBag.UserName, "OPCHCM001", StringComparison.OrdinalIgnoreCase))
                    {
                        <a href="#" onclick="runReport('@Url.Action("DanhSachHoaDon_Fill_HCM", "bangkehoadon")'
                                                      )">2.2 Bảng kê Hóa Đơn</a>
                    }
                    else
                    {
                        <a href="#" onclick="runReport('@Url.Action("DanhSachHoaDon_Fill", "bangkehoadon")'
                                                      )">2.2 Bảng kê Hóa Đơn</a>
                    }
                    <a href="#" onclick="runReport('@Url.Action("BaoCaoBanHangCN_Fill", "BaoCaobanHangCN")'
                                                      )">2.3 BC Bán Hàng CN</a>
                    <a href="#" onclick="runReport('@Url.Action("BaoCaoBanHangTDV_Fill", "BaoCaoBanHangTDV")'
                                                      )">2.4 BC Bán Hàng TDV</a>
                    @if (Request.Cookies["UserName"].Value == "vpct-nhatanh")
                    {
                        <a href="#" onclick="runReport('@Url.Action("BaoCaoTienVeCN2_Fill", "BaoCaoTienVeCN")'
                                                      )">2.5 BC Tiền Về CN</a>
                    }
                    else
                    {
                        <a href="#" onclick="runReport('@Url.Action("BaoCaoTienVeCN_Fill", "BaoCaoTienVeCN")'
                                                      )">2.5 BC Tiền Về CN</a>
                    }
                    <a href="#" onclick="runReport('@Url.Action("BaoCaoTienVeTDV_Fill", "BaoCaoTienVeCN")'
                                                      )">2.6 BC Tiền Về TDV</a>
                    <a href="#" onclick="runReport('@Url.Action("BaoCaoDoanhThuGamHangTheoDoiTuong_Fill", "BaoCaoDoanhThuGamHangTheoDoiTuong")'
                                                      )">2.7 BC DT Gam Theo Đối Tượng</a>
                    @if (string.Equals(ViewBag.UserName, "OPCTCKT001", StringComparison.OrdinalIgnoreCase))
                    {
                        <a href="#" onclick="runReport('@Url.Action("BaoCaoDTTinhLuongCTV_Fill_CongTy", "BaoCaoBanHangCTV")'
                                                      )">2.8 BC DT Tính Lương CTV</a>
                    }
                    else
                    {
                        <a href="#" onclick="runReport('@Url.Action("BaoCaoDTTinhLuongCTV_Fill", "BaoCaoBanHangCTV")'
                                                      )">2.8 BC DT Tính Lương CTV</a>
                    }
                    <a href="#" style="display:flex" onclick="runReport('@Url.Action("PhanTichBanHang_Fill", "PhanTichBanHang")'
                                                      )">
                        2.9 Phân Tích Bán Hàng
                    </a>
                </div>
                <div style="display:flex">
                    <div class="color3"></div>
                    <button class="submenu-btn" onclick="toggleSubmenu('submenu1_3','arrow-subicon_3')">
                        3.Báo Cáo Công Nợ <div id="arrow-subicon_3" class="subicon-arrow">
                            <i class="fa-solid fa-chevron-down"></i>
                        </div>
                    </button>
                </div>
                <div id="submenu1_3" class="submenu-container">
                    <a href="#" onclick="toggleSubmenu('submenu1_3_1','arrow-subicon_3_1')" style="display:flex;margin-left:15px">
                        3.1 Công Nợ Phải Thu<div id="arrow-subicon_3_1" class="subicon-arrow">
                            <i class="fa-solid fa-chevron-down"></i>
                        </div>
                    </a>
                    <div id="submenu1_3_1" class="submenu-container" style="margin-left:28px">
                        <a href="#" onclick="runReport('@Url.Action("BangDoiChieuCongNo_Fill", "MauInChungTu")'
                                                      )">3.1.1 Đối Chiếu Doanh Thu Công Nợ</a>
                        <a href="#" onclick="runReport('@Url.Action("BangDoiChieuDTCN_Fill", "MauInChungTu")'
                                                      )">3.1.2 Đối Chiếu Công Nợ</a>
                        @if (Request.Cookies["UserName"].Value == "vpct-nhatanh" || Request.Cookies["UserName"].Value == "opctckt001" || Request.Cookies["UserName"].Value == "OPCTCKT001")
                        {

                            <a href="#" onclick="runReport('@Url.Action("CongNoChiTietKH2_Fill", "CongNoChiTiet")'
                                                      )">3.1.3 Công Nợ Chi Tiết Của KH(PL5)</a>
                        }
                        else
                        {
                            <a href="#" onclick="runReport('@Url.Action("CongNoChiTietKH_Fill", "CongNoChiTiet")'
                                                      )">3.1.3 Công Nợ Chi Tiết Của KH(PL5)</a>
                        }
                        <a href="#" onclick="runReport('@Url.Action("ThongBaoNoQH_Fill", "MauInChungTu")'
                                                      )">3.1.4 Thông Báo Nợ QH</a>
                        <a href="#" onclick="runReport('@Url.Action("TonNo_Index", "MauInChungTu")'
                                                      )">3.1.5 Sổ Chi Tiết Tồn Nợ Phải Thu</a>
                        <a href="#" onclick="runReport('@Url.Action("SoChiTietPhaiThu_Fill", "SoChiTietPhaiThu")'
                                                      )">3.1.6 Sổ Chi Tiết Phải Thu Của KH</a>
                        <a href="#" onclick="runReport('@Url.Action("CongNoChiTietKH_ETC_Fill", "CongNoChiTiet")'
                                                      )">3.1.7 Công Nợ Chi Tiết Của KH ETC</a>
                        <a href="#" onclick="runReport('@Url.Action("SoTongHopCongNoPhaiThu_Fill", "SoTHPhaiThu")'
                                                      )">3.1.8 Sổ Tổng Hợp Phải Thu Của KH</a>

                    </div>
                    <a href="#" onclick="toggleSubmenu('submenu1_3_2','arrow-subicon_3_2')" style="display: flex; margin-left: 15px">
                        3.2 Công Nợ Phải Trả<div id="arrow-subicon_3_2" class="subicon-arrow">
                            <i class="fa-solid fa-chevron-down"></i>
                        </div>
                    </a>
                    <div id="submenu1_3_2" class="submenu-container" style="margin-left:28px">
                        @if (Request.Cookies["UserName"].Value == "vpct-nhatanh" || Request.Cookies["UserName"].Value == "opctckt001" || Request.Cookies["UserName"].Value == "OPCTCKT001")
                        {
                            <a href="#" onclick="runReport('@Url.Action("ChonCN", "SoChiTietPhaiTra")'
                                                      )">3.2.1 Sổ Chi Tiết Tồn Nợ Phải Trả</a>
                        }
                        else
                        {
                            <a href="#" onclick="runReport('@Url.Action("SoChiTietPhaiTra_Fill", "SoChiTietPhaiTra")'
                                                      )">3.2.1 Sổ Chi Tiết Tồn Nợ Phải Trả</a>}
                        <a href="#" style="display:flex" onclick="runReport('@Url.Action("TongHopCongNoPhaiTra_Fill", "TongHopPhaiTra")'
                                                      )">
                            3.2.2 Tổng Hợp Công Nợ Phải Trả
                        </a>
                        <a href="#" style="display:flex" onclick="runReport('@Url.Action("TongHopCongNoPhaiTra_Fill", "TongHopPhaiTra")'
                                                      )">
                            3.2.3 Chi Tiết Công Nợ Phải Trả
                        </a>
                    </div>
                </div>
                <div style="display:flex">
                    <div class="color4"></div>
                    <button class="submenu-btn" onclick="toggleSubmenu('submenu1_4','arrow-subicon_4')">
                        4.Báo Cáo Kế Toán <div id="arrow-subicon_4" class="subicon-arrow">
                            <i class="fa-solid fa-chevron-down"></i>
                        </div>
                    </button>
                </div>
                <div id="submenu1_4" class="submenu-container" style="padding-left:15px">
                    <!--<a href="#" style="display:flex" onclick="runReport('@Url.Action("SoQuyTienMat_Fill", "SoQuyTienMat")'
                                          )">
            4.1 Sổ Quỹ Tiền Mặt - Ngân hàng
        </a>
        <a href="#" style="display:flex" onclick="runReport('@Url.Action("PhieuKeToan", "PhieuKeToan")'
                                          )">
            4.2 Phiếu Kế Toán Khác
        </a>
        <a href="#" style="display:flex" onclick="runReport('@Url.Action("BaoCaoChiPhiKM_Fill", "BaoCaoChiPhiKhuyenMai")'
                                          )">
            4.3 BC Chi Phí Khuyến Mãi
        </a>-->
                    @*<a href="#" style="display:flex" onclick="runReport('@Url.Action("BaoCaoDoanhThuGV_Fill", "BaoCaoDoanhThuGV")'
                                              )">
                4.4 BC Doanh Thu Giá Vốn
            </a>*@
                    <!--<a href="#" style="display:flex" onclick="runReport('@Url.Action("BaoCaoTienVeThuong_Index", "BangKeNopTien")'
                                          )">
            4.4 BC Tiền Về(Thưởng)
        </a>
        <a href="#" style="display:flex" onclick="runReport('@Url.Action("BCanDoiSoPhatSinh_Fill", "CanDoiSoPhatSinh")'
                                          )">
            4.5 Cân Đối Số Phát Sinh
        </a>
        <a href="#" style="display:flex" onclick="runReport('@Url.Action("BaoCaoLaiLo_Fill", "BaoCaoLaiLo")'
                                          )">
            4.6 Báo Cáo Lãi Lỗ
        </a>-->
                    <a href="#" onclick="toggleSubmenu('submenu4_1_1','arrow-subicon_4_1')" style="display: flex">
                        4.1 Báo Cáo Nghiệp Vụ<div id="arrow-subicon_4_1" class="subicon-arrow">
                            <i class="fa-solid fa-chevron-down"></i>
                        </div>
                    </a>
                    <div id="submenu4_1_1" class="submenu-container" style="margin-left:28px">
                        <a href="#" style="display:flex" onclick="runReport('@Url.Action("SoQuyTienMat_Fill", "SoQuyTienMat")'
                                                      )">
                            4.1.1 Sổ Quỹ Tiền Mặt - Ngân hàng
                        </a>
                        <a href="#" style="display:flex" onclick="runReport('@Url.Action("PhieuKeToan", "PhieuKeToan")'
                                                      )">
                            4.1.2 Phiếu Kế Toán Khác
                        </a>
                        <a href="#" style="display:flex" onclick="runReport('@Url.Action("BaoCaoChiPhiKM_Fill", "BaoCaoChiPhiKhuyenMai")'
                                                      )">
                            4.1.3 BC Chi Phí Khuyến Mãi
                        </a>
                        @*<a href="#" style="display:flex" onclick="runReport('@Url.Action("BaoCaoDoanhThuGV_Fill", "BaoCaoDoanhThuGV")'
                                                  )">
                    4.4 BC Doanh Thu Giá Vốn
                </a>*@
                        <a href="#" style="display:flex" onclick="runReport('@Url.Action("BaoCaoTienVeThuong_Index", "BangKeNopTien")'
                                                      )">
                            4.1.4 BC Tiền Về(Thưởng)
                        </a>
                        <a href="#" style="display:flex" onclick="runReport('@Url.Action("BCanDoiSoPhatSinh_Fill", "CanDoiSoPhatSinh")'
                                                      )">
                            4.1.5 Cân Đối Số Phát Sinh
                        </a>
                        <a href="#" style="display:flex" onclick="runReport('@Url.Action("BaoCaoLaiLo_Fill", "BaoCaoLaiLo")'
                                                      )">
                            4.1.6 Báo Cáo Lãi Lỗ
                        </a>
                    </div>
                    <a href="#" onclick="toggleSubmenu('submenu4_2_1','arrow-subicon_4_2')" style="display: flex">
                        4.2 Báo Cáo Quản Trị<div id="arrow-subicon_4_2" class="subicon-arrow">
                            <i class="fa-solid fa-chevron-down"></i>
                        </div>
                    </a>
                    <div id="submenu4_2_1" class="submenu-container" style="margin-left:28px">

                        <a href="#" style="display:flex" onclick="runReport('@Url.Action("BaoCaoDoanhThuGV_Fill", "BaoCaoDoanhThuGV")'
                                                      )">
                            4.2.1 BC Doanh Thu Giá Vốn
                        </a>
                        <a href="#" style="display:flex" onclick="runReport('@Url.Action("BaoCaoDTGVLG_Fill", "BaoCaoDTGVLG")'
                                                      )">
                            4.2.2 BC Doanh Thu Giá Vốn Lãi Gộp
                        </a>
                    </div>

                </div>
                <div style="display:flex">
                    <div class="color5"></div>
                    <button class="submenu-btn" onclick="toggleSubmenu('submenu1_5','arrow-subicon_5')">
                        5.Báo Cáo Hợp Đồng <div id="arrow-subicon_5" class="subicon-arrow">
                            <i class="fa-solid fa-chevron-down"></i>
                        </div>
                    </button>
                </div>
                <div id="submenu1_5" class="submenu-container" style="padding-left:15px">
                    <a href="#" style="display:flex" onclick="runReport('@Url.Action("TheoDoiHopDongThau_Fill", "TheoDoiHDThau")'
                                                      )">
                        5.1 Theo Dõi Hợp Đồng Thầu
                    </a>
                    @if (Request.Cookies["UserName"].Value == "vpct-nhatanh")
                    {
                        <a href="#" style="display:flex" onclick="runReport('@Url.Action("Index", "BangKeNopTien")'
                                                      )">
                            5.2 Theo Dõi Bảng Kê Nộp Tiền
                        </a>}
                    else
                    {
                        <a href="#" style="display:flex" onclick="runReport('@Url.Action("BangKeNopTien_Fill", "BangKeNopTien")'
                                                      )">
                            5.2 Theo Dõi Bảng Kê Nộp Tiền
                        </a>
                    }

                </div>
                <div style="display:flex">
                    <div class="color6"></div>
                    <button class="submenu-btn" onclick="toggleSubmenu('submenu1_6','arrow-subicon_6')">
                        6.Báo Cáo Kho <div id="arrow-subicon_6" class="subicon-arrow">
                            <i class="fa-solid fa-chevron-down"></i>
                        </div>
                    </button>
                </div>
                <div id="submenu1_6" class="submenu-container" style="padding-left:15px">
                    <a href="#" style="display:flex" onclick="runReport('@Url.Action("TheKho_Fill", "TheKho")'
                                                      )">
                        6.1 Thẻ Kho
                    </a>
                    <button class="submenu-btn" onclick="toggleSubmenu('submenu6_2','arrow-subicon_6_2')">
                        6.2 Tổng Hợp Nhập Xuất Tồn <div id="arrow-subicon_6" class="subicon-arrow">
                            <i class="fa-solid fa-chevron-down"></i>
                        </div>
                    </button>
                    <div id="submenu6_2" class="submenu-container">
                        <a href="#" style="display:flex" onclick="runReport('@Url.Action("TongNhapXuatTonTheoKy_Fill", "THNhapXuatTonTheoTK")'
                                                      )">
                            6.2.1 Tổng Hợp Nhập Xuất Tồn Theo TK
                        </a>
                        <a href="#" style="display:flex" onclick="runReport('@Url.Action("TongNhapXuatTonTheoLo_Fill", "TheKho")'
                                                      )">
                            6.2.2 Tổng Hợp Nhập Xuất Tồn Theo Kho
                        </a>
                        @*<a href="#" style="display:flex" onclick="runReport('@Url.Action("PhieuNhapKho_Fill", "TheKho")'
                                                  )">
                    6.2 Phiếu Nhập Kho
                </a>
                <a href="#" style="display:flex" onclick="runReport('@Url.Action("PhieuXuatKho_Fill", "TheKho")'
                                                  )">
                    6.3 Phiếu Xuất Kho
                </a>
                <a href="#" style="display:flex" onclick="runReport('@Url.Action("PhieuNhapKho_Fill", "MauInChungTu")'
                                                  )">6.4.Phiếu Nhập Xuất Kho Khác</a>*@
                    </div>
                    @*<a href="#" style="display:flex" onclick="runReport('@Url.Action("TongNhapXuatTonTheoKy_Fill", "TheKho")'
                                              )">
                6.2 Tổng Hợp Nhập Xuất Tồn Theo TK
            </a>*@
                    <a href="#" style="display:flex" onclick="runReport('@Url.Action("PhieuNhapKho_Fill", "TheKho")'
                                                      )">
                        6.3 Phiếu Nhập Kho
                    </a>
                    <a href="#" style="display:flex" onclick="runReport('@Url.Action("PhieuXuatKho_Fill", "TheKho")'
                                                      )">
                        6.4 Phiếu Xuất Kho Có Giá Trị
                    </a>
                    <a href="#" style="display:flex" onclick="runReport('@Url.Action("PhieuNhapKho_Fill", "MauInChungTu")'
                                                      )">6.5.Phiếu Nhập Xuất Kho </a>
                    <a href="#" style="display:flex" onclick="runReport('@Url.Action("BienBanTuKiemKe_Fill", "BienBanTuKiemKe")'
                                                      )">6.6.Biên Bản Tự Kiểm Kê </a>
                </div>
                <div style="display:flex">
                    <div class="color7"></div>
                    <button class="submenu-btn" onclick="toggleSubmenu('submenu1_7','arrow-subicon_7')">
                        7.Báo Cáo MAR <div id="arrow-subicon_6" class="subicon-arrow">
                            <i class="fa-solid fa-chevron-down"></i>
                        </div>
                    </button>
                </div>
                <div id="submenu1_7" class="submenu-container" style="padding-left:15px">
                  
                    <a href="#" style="display:flex" onclick="runReport('@Url.Action("QuanLyTrungBay_Fill", "ViengTham")'
                                                      )">
                        7.1 Quản Lý Trưng Bày
                    </a>
                    <a href="#" style="display:flex" onclick="runReport('@Url.Action("ChiTietSPTraThuong_Fill", "ChiTietSPTraThuong")'
                                                      )">
                        7.2 Chi Tiết SP Trả Thưởng
                    </a>
                    @*<a href="#" style="display:flex" onclick="runReport('@Url.Action("PhieuNhapKho_Fill", "TheKho")'
                                              )">
                6.2 Phiếu Nhập Kho
            </a>
            <a href="#" style="display:flex" onclick="runReport('@Url.Action("PhieuXuatKho_Fill", "TheKho")'
                                              )">
                6.3 Phiếu Xuất Kho
            </a>
            <a href="#" style="display:flex" onclick="runReport('@Url.Action("PhieuNhapKho_Fill", "MauInChungTu")'
                                              )">6.4.Phiếu Nhập Xuất Kho Khác</a>*@
                </div>


                <div style="display:flex">
                    <div class="color8"></div>
                    <button class="submenu-btn" onclick="toggleSubmenu('submenu1_8','arrow-subicon_8')">
                        8.Báo Cáo Sản Xuất <div id="arrow-subicon_8" class="subicon-arrow">
                            <i class="fa-solid fa-chevron-down"></i>
                        </div>
                    </button>
                </div>
                <div id="submenu1_8" class="submenu-container" style="padding-left:15px">
                    <a href="#" style="display:flex" onclick="runReport('@Url.Action("", "BaoCaoMAR")'
                                                      )">
                        8.1 BC Thành Phẩm SX chờ QC
                    </a>
                    @*<a href="#" style="display:flex" onclick="runReport('@Url.Action("QuanLyTrungBay_Fill", "ViengTham")'
                                              )">
                7.2 Quản Lý Trưng Bày
            </a>
            <a href="#" style="display:flex" onclick="runReport('@Url.Action("ChiTietSPTraThuong_Fill", "ChiTietSPTraThuong")'
                                              )">
                7.3 Chi Tiết SP Trả Thưởng
            </a>*@
                    @*<a href="#" style="display:flex" onclick="runReport('@Url.Action("PhieuNhapKho_Fill", "TheKho")'
                                              )">
                6.2 Phiếu Nhập Kho
            </a>
            <a href="#" style="display:flex" onclick="runReport('@Url.Action("PhieuXuatKho_Fill", "TheKho")'
                                              )">
                6.3 Phiếu Xuất Kho
            </a>
            <a href="#" style="display:flex" onclick="runReport('@Url.Action("PhieuNhapKho_Fill", "MauInChungTu")'
                                              )">6.4.Phiếu Nhập Xuất Kho Khác</a>*@
                </div>

                <div style="display:flex">
                    <div class="color9"></div>
                    <button class="submenu-btn" onclick="toggleSubmenu('submenu1_9','arrow-subicon_9')">
                        9.BC Quản Trị OTC-ETC <div id="arrow-subicon_9" class="subicon-arrow">
                            <i class="fa-solid fa-chevron-down"></i>
                        </div>
                    </button>
                </div>
              
                    <div id="submenu1_9" class="submenu-container">
                        <a href="#" onclick="toggleSubmenu('submenu1_9_1','arrow-subicon_9_1')" style="display:flex;margin-left:15px">
                            9.1 Quản trị OTC<div id="arrow-subicon_9_1" class="subicon-arrow">
                                <i class="fa-solid fa-chevron-down"></i>
                            </div>
                        </a>
                        <div id="submenu1_9_1" class="submenu-container" style="margin-left:28px">
                            <a href="#" style="display:flex" onclick="runReport('@Url.Action("BaoCaoMar_Fill", "BaoCaoMAR")'
                                                      )">
                                9.1.1 BC Doanh Thu Bán Hàng OTC
                            </a>




                        </div>
                        <a href="#" onclick="toggleSubmenu('submenu1_9_2','arrow-subicon_9_2')" style="display: flex; margin-left: 15px">
                            9.2 Quản Trị ETC<div id="arrow-subicon_9_2" class="subicon-arrow">
                                <i class="fa-solid fa-chevron-down"></i>
                            </div>
                        </a>
                        <div id="submenu1_9_2" class="submenu-container" style="margin-left:28px">
                          
                            @*<a href="#" style="display:flex" onclick="runReport('@Url.Action("TongHopCongNoPhaiTra_Fill", "TongHopPhaiTra")'
                                                      )">
                                3.2.3 Chi Tiết Công Nợ Phải Trả
                            </a>*@
                        </div>
                    </div>
                    @*<a href="#" style="display:flex" onclick="runReport('@Url.Action("QuanLyTrungBay_Fill", "ViengTham")'
                                          )">
            7.2 Quản Lý Trưng Bày
        </a>
        <a href="#" style="display:flex" onclick="runReport('@Url.Action("ChiTietSPTraThuong_Fill", "ChiTietSPTraThuong")'
                                          )">
            7.3 Chi Tiết SP Trả Thưởng
        </a>*@
                    @*<a href="#" style="display:flex" onclick="runReport('@Url.Action("PhieuNhapKho_Fill", "TheKho")'
                                          )">
            6.2 Phiếu Nhập Kho
        </a>
        <a href="#" style="display:flex" onclick="runReport('@Url.Action("PhieuXuatKho_Fill", "TheKho")'
                                          )">
            6.3 Phiếu Xuất Kho
        </a>
        <a href="#" style="display:flex" onclick="runReport('@Url.Action("PhieuNhapKho_Fill", "MauInChungTu")'
                                          )">6.4.Phiếu Nhập Xuất Kho Khác</a>*@
               
            </div>

            <button class="dropdown-btn" onclick="toggleSubmenu('submenu2','arrow2')">
                <div class="sidebar-title">
                    <i class="fa-solid fa-print"></i>
                    <div>Mẫu In</div>
                </div>
                <div id="arrow2" class="icon-arrow-2">
                    <i class="fa-solid fa-chevron-down"></i>
                </div>
            </button>
            <div id="submenu2" class="dropdown-container submenu-container">

                <a href="#" onclick="runReport('@Url.Action("MauInNLCB_Fill", "MauInChungTu")'
                                                      )">1.Chứng Từ Phiếu Nhập</a>
                <a href="#" onclick="runReport('@Url.Action("PhieuNhapXNTT_Fill", "PhieuXNTT")'
                                                      )">2.Phiếu Xác Nhận Thanh Toán</a>
                <button class="submenu-btn" onclick="toggleSubmenu('submenu2_3','arrow-subicon_2_1')">
                    3.Phiếu Xác Nhận TT CKTT <div id="arrow-subicon_6" class="subicon-arrow">
                        <i class="fa-solid fa-chevron-down"></i>
                    </div>
                </button>
                <div id="submenu2_3" class="submenu-container">
                    <a href="#" style="display:flex" onclick="runReport('@Url.Action("PhieuXacNhanTTTCK2_Fill", "MauInChungTu")'
                                                      )">
                        3.1 Phiếu Xác Nhận Thanh Toán Bù Trừ
                    </a>
                    <a href="#" style="display:flex" onclick="runReport('@Url.Action("PhieuXacNhanTTTCK_Fill", "MauInChungTu")'
                                                      )">
                        3.2 Phiếu Xác Nhận Thanh Toán Chi Tiền
                    </a>
                    @*<a href="#" style="display:flex" onclick="runReport('@Url.Action("PhieuNhapKho_Fill", "TheKho")'
                                                          )">
                            6.2 Phiếu Nhập Kho
                        </a>
                        <a href="#" style="display:flex" onclick="runReport('@Url.Action("PhieuXuatKho_Fill", "TheKho")'
                                                          )">
                            6.3 Phiếu Xuất Kho
                        </a>
                        <a href="#" style="display:flex" onclick="runReport('@Url.Action("PhieuNhapKho_Fill", "MauInChungTu")'
                                                          )">6.4.Phiếu Nhập Xuất Kho Khác</a>*@
                </div>
                <a href="#" onclick="runReport('@Url.Action("PhieuXuatKho_SO", "MauInChungTu")'
                                                      )">4.Mẫu In SO</a>

                <a href="#" onclick="runReport('@Url.Action("BienBanBanGiaoNTHH_Fill", "MauInChungTu")'
                                                      )">5.Biên Bản Bàn Giao Và Nghiệm Thu Hàng Hóa</a>
                <a href="#" onclick="runReport('@Url.Action("PhieuDatHang_Fill", "TheKho")'
                                                      )">6.Phiếu Đặt Hàng</a>
            </div>


            <button class="dropdown-btn" onclick="toggleSubmenu('submenu3','arrow3')">
                <div class="sidebar-title">
                    <i class="fa-solid fa-table-list"></i>
                    <div>Danh Mục</div>
                </div>
                <div id="arrow3" class="icon-arrow-3">
                    <i class="fa-solid fa-chevron-down"></i>
                </div>
            </button>
            <div id="submenu3" class="dropdown-container submenu-container">
                @if (string.Equals(ViewBag.UserName, "admin", StringComparison.OrdinalIgnoreCase) ||
            string.Equals(ViewBag.UserName, "opcmar001", StringComparison.OrdinalIgnoreCase))
                {
                    <a href="#" onclick="runReport('@Url.Action("ViewDanhMucKH_Fill", "DanhMuc")'
                                                      )">1.Danh Mục Khách Hàng</a>
                }
                else if (string.Equals(ViewBag.UserName, "OPCHCM001", StringComparison.OrdinalIgnoreCase))
                {


                    <a href="#" onclick="runReport('@Url.Action("ViewDanhMucKH_FillCN", "DanhMuc")'
                                                      )">1.Danh Mục Khách Hàng</a>
                }
                else
                {
                    <a href="#" onclick="runReport('@Url.Action("ViewDanhMucKHCN", "DanhMuc")'
                                                      )">1.Danh Mục Khách Hàng</a>
                }
                <a href="#" onclick="runReport('@Url.Action("Index", "CongTacVien")'
                                                      )">2.Danh Mục Hạn Mức CTV</a>
                <a href="#" onclick="runReport('@Url.Action("Index", "TheoDoiGiaoHang")'
                                                      )">3.Theo Dõi Giao Hàng</a>

                <a href="#" onclick="runReport('@Url.Action("Index", "SPTrungBay")'
                                                      )">4.Sản Phẩm Trưng Bày</a>
                <a href="#" onclick="runReport('@Url.Action("Index", "FormBKNopTien")'
                                                      )">5.Bảng Kê Nộp Tiền</a>
                <a href="#" onclick="runReport('@Url.Action("Index", "CongTacVienCap2")'
                                                      )">6.Hóa Đơn Khách Hàng Cấp 2</a>
                @*<button class="submenu-btn" onclick="toggleSubmenu('submenu2_2')">Báo Cáo Quản Trị</button>
        <div id="submenu2_2" class="submenu-container">
            <a href="#">Submenu 1.2.1</a>
            <a href="#">Submenu 1.2.2</a>
        </div>
        <button class="submenu-btn" onclick="toggleSubmenu('submenu3_3')">Báo Cáo Nghiệp Vụ</button>
        <div id="submenu3_3" class="submenu-container">
            <a href="#">Submenu 1.3.1</a>
            <a href="#">Submenu 1.3.2</a>
        </div>*@
            </div>
            <a onclick="ChangePassword()" href="/Home/DoiMatKhau"><div class="sidebar-title"><i class="fa-solid fa-lock"></i> <div>Đổi Mật Khẩu</div></div></a>
            <a onclick="logout()"><div class="sidebar-title"><i class="fa-solid fa-right-from-bracket"></i> <div>Đăng Xuất</div></div></a>
        </div>
    </nav>
    @*<div class="mobile-menu-overlay"></div>*@
    <section class="main-container">
        <div class="header">
            <div class="header-left">




            </div>

            <div class="header-right">

                <div class="welcome-txt">WELCOME BACK</div>
                <div class="user-txt">@Request.Cookies["UserName"].Value</div>
                @if (Request.Cookies["UserName"].Value == "Admin" || Request.Cookies["UserName"].Value == "ADMIN"|| Request.Cookies["UserName"].Value == "admin"|| Request.Cookies["UserName"].Value == "opctckt001"|| Request.Cookies["UserName"].Value == "OPCTCKT001")
                {
                    <div class="madvcs"><a id="companyName">@tendv</a></div>
                }
            </div>
        </div>
        <div class="main-content">
            <div class="box">
                <div class="box-row">
                    <div class="box-1">
                        <div>
                            <h5 class="text">TỔNG DOANH THU</h5>
                            <h5 class="num">
                                @foreach (DataRow row3 in Model.Tables[0].Rows)
                                {
                                    @row3["Tong_Doanh_Thu_Nam"]
                                }
                            </h5>
                        </div>
                    </div>
                    <div class="box-2">
                        <div>
                            <h5 class="text">DOANH THU THÁNG HIỆN TẠI</h5>
                            <h5 class="num">
                                @foreach (DataRow row3 in Model.Tables[1].Rows)
                                {
                                    @row3["Tong_Doanh_Thu_Thang"]
                                }
                            </h5>
                        </div>
                    </div>
                </div>
                <div class="box-row">
                    <div class="box-3">
                        <div>
                            <h5 class="text">TỔNG ĐƠN HÀNG THÁNG HIỆN TẠI</h5>
                            <h5 class="num">
                                @foreach (DataRow row3 in Model.Tables[2].Rows)
                                {
                                    @row3["So_Luong_HD"]

                                }
                            </h5>
                        </div>
                    </div>
                    <div class="box-4">
                        <div>
                            <h5 class="text">TỔNG GIÁ TRỊ TỒN KHO</h5>
                            <h5 class="num">
                                @foreach (DataRow row3 in Model.Tables[3].Rows)
                                {
                                    @row3["gia_tri_ton"]
                                }
                            </h5>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row-chart-1">
                <div class="percent-chart">
                    <div class="top">
                        <div class="pie"><h5>Tỷ lệ % so với kế hoạch (Năm)</h5><h6 style="font-size:13px;text-align:center">Khoán năm: @KhoanNam.ToString().Substring(0, 3) Tỷ (100%)</h6><canvas id="myPieChart" style="width:100%;height:100%"></canvas></div>
                        @*<div style="background-color:red;width:20px;height:20px;position:relative">Đạt được: 139M</div>*@
                    </div>
                    <div class="bottom">
                        <div class="pie">
                            <h5>Tỷ lệ % so với kế hoạch (Tháng)</h5>@{
                                // Xác định độ dài của biến KhoanThang
                                int length = KhoanThang.ToString().Length;

                                // Chuỗi con mà bạn muốn hiển thị
                                string khoanThangSubstring = length <= 10 ? KhoanThang.ToString().Substring(0, 1) : KhoanThang.ToString().Substring(0, 2);
                            }<h6 style="font-size:13px;text-align:center">Khoán tháng: @khoanThangSubstring Tỷ (100%)</h6><canvas id="myPieChart2" style="width:100%;height:100%"></canvas>
                        </div>
                    </div>

                </div>
                <div class="line-chart"><div id="combinedChartContainer" style="height: 100%;"></div></div>



            </div>
            <div class="row-chart-1">
                <div class="percent-chart">
                    <div class="top"><div class="pie"><h5>Tỷ lệ % doanh thu OTC so với kế hoạch</h5><canvas id="myPieChart3" style="width:100%;height:100%"></canvas></div></div>
                    <div class="bottom"> <div class="pie"><h5>Tỷ lệ % doanh thu ETC so với kế hoạch</h5><canvas id="myPieChart4" style="width:100%;height:100%"></canvas></div></div>
                </div>
                <div class="line-chart"><div id="container3" style="height: 100%;"></div></div>
            </div>
            <div class="row-chart-2">
                <div class="left-chart">
                    <div id="revenueChart"></div>
                </div>
                <div class="right-chart">
                    <div id="container"></div>
                </div>
            </div>
            <div class="row-table">
                <div class="table">
                    <div class="title-table">TOP 10 SẢN PHẨM DOANH THU CAO NHẤT</div>
                    <table>
                        <thead>
                            <tr>

                                <td>Mã Vật Tư</td>
                                <td>Tên Vật Tư</td>
                                <td>Doanh Thu</td>
                            </tr>
                        </thead>
                        <tbody>

                            @foreach (DataRow row3 in Model.Tables[7].Rows)
                            {
                                if (rowCount >= 10)
                                {
                                    break; // thoát khỏi vòng lặp sau khi hiển thị 10 dòng
                                }
                                <tr class="table2-data hidden-row @((row3.Table.Rows.IndexOf(row3) % 2 == 0) ? "even" : "odd")">
                                    <td style="text-align: center; font-size: 14px">@row3["Ma_Vt"]</td>
                                    <td style="text-align: left; font-size: 14px">@row3["Ten_Vt"]</td>
                                    <td style="text-align: right; font-size: 14px">@string.Format("{0:#,###}", row3["Doanh_Thu"]).Replace(",", ".")</td>
                                </tr>
                                rowCount++;
                            }

                        </tbody>
                    </table>
                </div>
                <div class="chart-table"><div id="container-2"></div></div>
            </div>

        </div>
    </section>
    <div id="myModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div class="body">
                <div>COMPANY</div>
                <div class="select-btn">
                    <select name="Chitiet" id="chitietselect" @*onchange="saveSelectedValueToCookie3()"*@>
                        <option value="" style="background-color: #020024;color:white">Chọn giá trị</option>
                        <option value="OPC_CT">OPC_CT Chi Nhánh Cần Thơ</option>
                        <option value="OPC_TG">OPC_TG Chi Nhánh Tiền Giang</option>
                        <option value="OPC_MD">OPC_MD Chi Nhánh Miền Đông</option>
                        <option value="OPC_TP">OPC_TP Chi Nhánh Hồ Chí Minh</option>
                        <option value="OPC_VT">OPC_VT Chi Nhánh Vũng Tàu</option>
                        <option value="OPC_NT">OPC_NT Chi Nhánh Nha Trang</option>
                        <option value="OPC_DN">OPC_DN Chi Nhánh Đà Nẵng</option>
                        <option value="OPC_NA">OPC_NA Chi Nhánh Nghệ An</option>
                        <option value="OPC_HN">OPC_HN Chi Nhánh Hà Nội</option>
                        <option value="OPC">Văn Phòng Trụ Sở</option>
                        <option value="">Công Ty Cổ Phần Dược Phẩm OPC</option>
                    </select>
                </div>
                <div class="button-container">
                    <button class="accept-btn"onclick="acceptSelection()">Accept</button>
                    <span class="cancel-btn">Cancel</span>
                </div>
            </div>
        </div>
    </div>


    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/modules/solid-gauge.js"></script>
    <script src="https://code.highcharts.com/highcharts-more.js"></script>
    <script src="https://code.highcharts.com/highcharts-3d.js"></script>
    <script src="https://code.highcharts.com/modules/exporting.js"></script>
    <script src="https://code.highcharts.com/modules/export-data.js"></script>
    <script src="https://code.highcharts.com/modules/accessibility.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  
    <script>
       
        function updateCompanyNameFromCookie() {
            var companyNameElement = document.getElementById("companyName");
            var maDVCS = getCookie("MA_DVCS");

            if (maDVCS) {
                companyNameElement.textContent = maDVCS;
            } else {
                companyNameElement.textContent = "Công ty Cổ Phần Dược Phẩm OPC"; // Nếu không có cookie, sử dụng mặc định
            }
        }
    </script>
    <script>
        function getCookieNameDropDown(cname) {
            let name = cname + "=";
            let decodedCookie = decodeURIComponent(document.cookie);
            let ca = decodedCookie.split(';');
            for (let i = 0; i < ca.length; i++) {
                let c = ca[i];
                while (c.charAt(0) == ' ') {
                    c = c.substring(1);
                }
                if (c.indexOf(name) == 0) {
                    return c.substring(name.length, c.length);
                }
            }
            return "";
        }
        function getCookie(name) {
            var cookies = document.cookie.split(';');
            for (var i = 0; i < cookies.length; i++) {
                var cookie = cookies[i].trim();
                if (cookie.indexOf(name) === 0) {
                    return cookie.substring(name.length + 1);
                }
            }
            return null;
        }
        function saveSelectedValueToCookie3() {
            var selectElement = document.getElementById("chitietselect");
            var selectedValue = selectElement.value;

            // Lưu giá trị vào cookie có tên "MA_DVCS" với hạn sử dụng 1 ngày
            document.cookie = "MA_DVCS=" + selectedValue + "; expires=Thu, 01 Jan 2026 00:00:00 UTC; path=/";
        }
        
        function updateCompanyNameFromDropdown() {
            var selectElement = document.getElementById("chitietselect");
            var selectedOption = selectElement.options[selectElement.selectedIndex].textContent;
            var companyNameElement = document.getElementById("companyName");

            if (selectedOption) {
                companyNameElement.textContent = selectedOption;
            } else {
                // Nếu không chọn gì, cập nhật từ giá trị ban đầu
                var dropdownSelect = document.getElementById("chitietselect");
                for (var i = 0; i < dropdownSelect.options.length; i++) {
                    if (dropdownSelect.options[i].value === initialDropdownValue) {
                        dropdownSelect.selectedIndex = i;
                        companyNameElement.textContent = dropdownSelect.options[i].textContent;
                        break;
                    }
                }
            }
        }

    </script>
    <script>
        // Lấy thẻ modal và các nút đóng
        var modal = document.getElementById("myModal");
        var btnClose = document.getElementsByClassName("close");
        var cancelBtn = document.getElementsByClassName("cancel-btn")[0];
        // Lấy thẻ dòng chữ "Công ty..."
        var companyName = document.getElementById("companyName");

        // Khi click vào dòng chữ "Công ty...", hiển thị modal
        companyName.onclick = function () {
            modal.style.display = "block";
        }

        // Khi người dùng click vào nút đóng hoặc nút Cancel, ẩn modal
        for (var i = 0; i < btnClose.length; i++) {
            btnClose[i].onclick = function () {
                modal.style.display = "none";
            }
        }
        cancelBtn.addEventListener("click", function () {
            modal.style.display = "none";
        });
        // Khi người dùng click bất kỳ đâu ngoài modal, ẩn modal
        window.onclick = function (event) {
            if (event.target == modal) {
                modal.style.display = "none";
            }
        }

    </script>
    <script>
        function acceptSelection() {
            var modal = document.getElementById("myModal");
            modal.style.display = "none";
            saveSelectedValueToCookie3();
            window.location.reload(); // Reload trang khi click vào nút "Chấp Nhận"
        }
        //window.onload = function () {
        //    // Cập nhật nội dung từ cookie khi trang được tải
            
        //};
    </script>
    <script>


        //// Lấy thẻ modal và nút đóng
        //var modal = document.getElementById("myModal");
        //var span = document.getElementsByClassName("close")[0];

        //// Khi người dùng click vào nút đóng, ẩn modal
        //span.onclick = function () {
        //    modal.style.display = "none";
        //}

        //// Khi người dùng click bất kỳ đâu ngoài modal, ẩn modal
        //window.onclick = function (event) {
        //    if (event.target == modal) {
        //        modal.style.display = "none";
        //    }
        //}

        function ChangPassword() {
            // Điều hướng đến trang thay đổi mật khẩu
            window.location.href = "/home/DoiMatKhau";
        }
        function runReport(actionUrl) {
            var url = actionUrl;
            var newWindow = window.open('', '_blank');
            newWindow.location.href = url;
        }
        window.onload = function () {
            var username = localStorage.getItem("username");
            if (username) {
                var nameInput = document.getElementById("Name");
                if (nameInput) {
                    nameInput.value = username;
                }
                localStorage.removeItem("username");
            }
  
            var cookieValue = getCookieNameDropDown("MA_DVCS");
            var dropdownSelect = document.getElementById("chitietselect");
            initialDropdownValue = cookieValue;
            // Duyệt qua tất cả các option trong dropdown
            for (var i = 0; i < dropdownSelect.options.length; i++) {
                // Nếu giá trị option trùng với giá trị cookie
                if (dropdownSelect.options[i].value === cookieValue) {
                    // Đặt option đó làm option mặc định
                    dropdownSelect.selectedIndex = i;
                    break;
                }
            }
         /*   updateCompanyNameFromCookie();*/
        };
    </script>
    <script>
        function logout() {
            // Làm rỗng mảng tabArray
            const tabArray = JSON.parse(localStorage.getItem("tabsArray")) || [];
            tabArray.length = 0;
            localStorage.setItem("tabsArray", JSON.stringify(tabArray));

            // Điều hướng đến trang đăng nhập
            window.location.href = "/home/login";
        }
        function toggleSubmenu(submenuId, arrowId) {
            var submenu = document.getElementById(submenuId);
            var arrow = document.getElementById(arrowId);

            if (submenu.style.display === 'block') {
                submenu.style.display = 'none';
                arrow.innerHTML = '<i class="fa-solid fa-chevron-down"></i>';
            } else {
                submenu.style.display = 'block';
                arrow.innerHTML = '<i class="fa-solid fa-chevron-up"></i>';
            }
        }
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const nav = document.querySelector('nav');
            const toggleBtn = document.getElementById('toggle-btn');
            const content = document.querySelector('.main-container');
            const span = document.querySelector('.logo-content');

            function checkScreenWidth() {
                if (window.innerWidth <= 2000) {
                    nav.classList.add('hide');
                    span.classList.add('hide');
                    content.classList.add('expand');
                    /* mobile.classList.add('show');*/
                } else {
                    nav.classList.remove('hide');
                    span.classList.remove('hide');
                    content.classList.remove('expand');
                    /*  mobile.classList.remove('show');*/
                }
            }

            // Kiểm tra kích thước màn hình khi trang web được tải lên
            checkScreenWidth();

            // Thêm sự kiện resize để kiểm tra lại khi kích thước màn hình thay đổi
            window.addEventListener('resize', function () {
                checkScreenWidth();
            });

            toggleBtn.onclick = function () {
                nav.classList.toggle('hide');
                span.classList.toggle('hide');
                content.classList.toggle('expand');
                /* mobile.classList.toggle('show');*/
                // Nếu sidebar được mở ra, thêm class "open" cho .left-sidebar và .main-container
                //if (nav.classList.contains('hide')) {
                //    nav.classList.add('open');
                //    content.classList.add('open');
                //} else {
                //    // Ngược lại, loại bỏ class "open" nếu sidebar được đóng lại
                //    nav.classList.remove('open');
                //    content.classList.remove('open');
                //}
            };
        });

    </script>
    <script>
        Highcharts.chart('container', {
            chart: {
                type: 'gauge',
                plotBackgroundColor: null,
                plotBackgroundImage: null,
                plotBorderWidth: 0,
                plotShadow: false
            },

            title: {
                text: 'Speedometer'
            },

            pane: {
                startAngle: -150,
                endAngle: 150,
                background: [{
                    backgroundColor: {
                        linearGradient: { x1: 0, y1: 0, x2: 0, y2: 1 },
                        stops: [
                            [0, '#FFF'],
                            [1, '#333']
                        ]
                    },
                    borderWidth: 0,
                    outerRadius: '109%'
                }, {
                    backgroundColor: {
                        linearGradient: { x1: 0, y1: 0, x2: 0, y2: 1 },
                        stops: [
                            [0, '#333'],
                            [1, '#FFF']
                        ]
                    },
                    borderWidth: 1,
                    outerRadius: '107%'
                }, {
                    // default background
                }, {
                    backgroundColor: '#DDD',
                    borderWidth: 0,
                    outerRadius: '105%',
                    innerRadius: '103%'
                }]
            },

            // the value axis
            yAxis: {
                min: 0,
                max: 200,

                minorTickInterval: 'auto',
                minorTickWidth: 1,
                minorTickLength: 10,
                minorTickPosition: 'inside',
                minorTickColor: '#666',

                tickPixelInterval: 30,
                tickWidth: 2,
                tickPosition: 'inside',
                tickLength: 10,
                tickColor: '#666',
                labels: {
                    step: 2,
                    rotation: 'auto'
                },
                title: {
                    text: 'km/h'
                },
                plotBands: [{
                    from: 0,
                    to: 120,
                    color: '#55BF3B' // green
                }, {
                    from: 120,
                    to: 160,
                    color: '#DDDF0D' // yellow
                }, {
                    from: 160,
                    to: 200,
                    color: '#DF5353' // red
                }]
            },

            series: [{
                name: 'Speed',
                data: [80],
                tooltip: {
                    valueSuffix: ' km/h'
                }
            }]

        });
    </script>
    <script>
        var chart = Highcharts.chart('gaugeChart3', {
            chart: {
                plotBackgroundColor: null,
                plotBorderWidth: 0,
                plotShadow: false
            },
            title: {
                text: '<div class="text-chart">Tỷ lệ tăng</br> trưởng doanh thu</div>',
                align: 'center',
                verticalAlign: 'middle',
                y: 60
            },
            tooltip: {
                pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
            },
            accessibility: {
                point: {
                    valueSuffix: '%'
                }
            },
            plotOptions: {
                pie: {
                    dataLabels: {
                        enabled: true,
                        distance: -50,
                        style: {
                            fontWeight: 'bold',
                            color: 'white'
                        }
                    },
                    startAngle: -90,
                    endAngle: 90,
                    center: ['50%', '75%'],
                    size: '110%'
                }
            },
            series: [{
                type: 'pie',
                name: 'Browser share',
                innerSize: '50%',
                data: [
                    ['Đạt được', 70.00],
                    //['Edge', 11.97],
                    //['Firefox', 5.52],
                    //['Safari', 2.98],
                    //['Internet Explorer', 1.90],
                    ['Còn lại', 30.00]
                ]
            }]
        });

        // Thêm tiêu đề phía trên biểu đồ
        chart.setTitle({
            text: 'Tỷ lệ % so với kế hoạch',
            align: 'center',
            verticalAlign: 'top',
            y: 10, // Điều chỉnh khoảng cách từ trên xuống
            style: {
                fontSize: '16px', // Tuỳ chỉnh kích thước font chữ nếu cần thiết
                fontWeight: 'bold'
            }
        });
    </script>



    <script>
        Highcharts.chart('gaugeChart1', {
            chart: {
                plotBackgroundColor: null,
                plotBorderWidth: 0,
                plotShadow: false
            },
            title: {
                text: '<div class="text-chart">Tỷ lệ tăng</br> trưởng doanh thu</div>',
                align: 'center',
                verticalAlign: 'middle',
                y: 60
            },
            tooltip: {
                pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
            },
            accessibility: {
                point: {
                    valueSuffix: '%'
                }
            },
            plotOptions: {
                pie: {
                    dataLabels: {
                        enabled: true,
                        distance: -50,
                        style: {
                            fontWeight: 'bold',
                            color: 'white'
                        }
                    },
                    startAngle: -90,
                    endAngle: 90,
                    center: ['50%', '75%'],
                    size: '110%'
                }
            },
            series: [{
                type: 'pie',
                name: 'Browser share',
                innerSize: '50%',
                data: [
                    ['Chrome', 70.00],
                    //['Edge', 11.97],
                    //['Firefox', 5.52],
                    //['Safari', 2.98],
                    //['Internet Explorer', 1.90],
                    ['Other', 30.00]
                ]
            }]
        });
    </script>
    <script>
        var chart = Highcharts.chart('gaugeChart2', {
            chart: {
                plotBackgroundColor: null,
                plotBorderWidth: 0,
                plotShadow: false
            },
            title: {
                text: '<div class="text-chart">Tỷ lệ tăng</br> trưởng doanh thu</div>',
                align: 'center',
                verticalAlign: 'middle',
                y: 60
            },
            tooltip: {
                pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
            },
            accessibility: {
                point: {
                    valueSuffix: '%'
                }
            },
            plotOptions: {
                pie: {
                    dataLabels: {
                        enabled: true,
                        distance: -50,
                        style: {
                            fontWeight: 'bold',
                            color: 'white'
                        }
                    },
                    startAngle: -90,
                    endAngle: 90,
                    center: ['50%', '75%'],
                    size: '110%'
                }
            },
            series: [{
                type: 'pie',
                name: 'Browser share',
                innerSize: '50%',
                data: [
                    ['Đạt được', 70.00],
                    //['Edge', 11.97],
                    //['Firefox', 5.52],
                    //['Safari', 2.98],
                    //['Internet Explorer', 1.90],
                    ['Còn lại', 30.00]
                ]
            }]
        });

        // Thêm tiêu đề phía trên biểu đồ
        chart.setTitle({
            text: 'Tỷ lệ % so với kế hoạch',
            align: 'center',
            verticalAlign: 'top',
            y: 10, // Điều chỉnh khoảng cách từ trên xuống
            style: {
                fontSize: '16px', // Tuỳ chỉnh kích thước font chữ nếu cần thiết
                fontWeight: 'bold'
            }
        });
    </script>
    <!-- Viết mã JavaScript để tạo biểu đồ -->
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Dữ liệu doanh thu của 9 chi nhánh
            var revenueData = [  @foreach (DataRow row3 in Model.Tables[6].Rows)
                                {
                    @row3["CongTy"].ToString().Replace(",", "")
                                },
                          @foreach (DataRow row3 in Model.Tables[6].Rows)

                                {
                                   @row3["CNCT"].ToString().Replace(",", ".")
                                },
                @foreach (DataRow row3 in Model.Tables[6].Rows)
                                {
                                   @row3["CNTG"].ToString().Replace(",", ".")
                                },
                @foreach (DataRow row3 in Model.Tables[6].Rows) {

                                   @row3["CNHCM"].ToString().Replace(",", ".")
                                },
                @foreach (DataRow row3 in Model.Tables[6].Rows)
                                {
                                   @row3["CNMD"].ToString().Replace(",", "")
                                },
                @foreach (DataRow row3 in Model.Tables[6].Rows)
                                {
                                   @row3["CNVT"].ToString().Replace(",", ".")
                                },
                @foreach (DataRow row3 in Model.Tables[6].Rows)
                                {
                                   @row3["CNNT"].ToString().Replace(",", ".")
                                },
                @foreach (DataRow row3 in Model.Tables[6].Rows)
                                {
                                   @row3["CNDN"].ToString().Replace(",", ".")
                                },
                @foreach (DataRow row3 in Model.Tables[6].Rows)
                                {
                                   @row3["CNNA"].ToString().Replace(",", ".")
                                },
                @foreach (DataRow row3 in Model.Tables[6].Rows)
                                {
                                   @row3["OPC_HN"].ToString().Replace(",", ".")
                                }

               ];

            // Cấu hình biểu đồ
            var chartConfig = {
                chart: {
                    type: 'column',
                    options3d: {
                        enabled: true,
                        alpha: 45
                    }
                },
                title: {
                    text: 'Doanh Thu Chi Nhánh'
                },
                xAxis: {
                    categories: ['Công Ty','Cần Thơ', 'Tiền Giang', 'Hồ Chí Minh', 'Miền Đông', 'Vũng Tàu', 'Nha Trang', 'Đà Nẵng', 'Nghệ An', 'Hà Nội']
                },
                yAxis: {
                    title: {
                        text: 'Doanh Thu (VND)'
                    }
                },
                series: [{
                    name: 'Doanh Thu',
                    data: revenueData
                }],
                plotOptions: {
                    column: {
                        dataLabels: {
                            enabled: true,
                            format: '{point.y:,.0f}',  // Hiển thị giá trị của cột
                            style: {
                                fontWeight: 'bold',
                                color: 'black'
                            }
                        }
                    }
                }
            };

            // Vẽ biểu đồ trong container có id là 'revenueChart'
            Highcharts.chart('revenueChart', chartConfig);
        });

    </script>

    <script>
        (function (H) {
            H.seriesTypes.pie.prototype.animate = function (init) {
                const series = this,
                    chart = series.chart,
                    points = series.points,
                    {
                        animation
                    } = series.options,
                    {
                        startAngleRad
                    } = series;

                function fanAnimate(point, startAngleRad) {
                    const graphic = point.graphic,
                        args = point.shapeArgs;

                    if (graphic && args) {

                        graphic
                            // Set inital animation values
                            .attr({
                                start: startAngleRad,
                                end: startAngleRad,
                                opacity: 1
                            })
                            // Animate to the final position
                            .animate({
                                start: args.start,
                                end: args.end
                            }, {
                                duration: animation.duration / points.length
                            }, function () {
                                // On complete, start animating the next point
                                if (points[point.index + 1]) {
                                    fanAnimate(points[point.index + 1], args.end);
                                }
                                // On the last point, fade in the data labels, then
                                // apply the inner size
                                if (point.index === series.points.length - 1) {
                                    series.dataLabelsGroup.animate({
                                        opacity: 1
                                    },
                                        void 0,
                                        function () {
                                            points.forEach(point => {
                                                point.opacity = 1;
                                            });
                                            series.update({
                                                enableMouseTracking: true
                                            }, false);
                                            chart.update({
                                                plotOptions: {
                                                    pie: {
                                                        innerSize: '40%',
                                                        borderRadius: 8
                                                    }
                                                }
                                            });
                                        });
                                }
                            });
                    }
                }

                if (init) {
                    // Hide points on init
                    points.forEach(point => {
                        point.opacity = 0;
                    });
                } else {
                    fanAnimate(points[0], startAngleRad);
                }
            };
        }(Highcharts));

        Highcharts.chart('container', {
            chart: {
                type: 'pie'
            },
            title: {
                text: 'Doanh Thu Chi Nhánh',
                align: 'left'
            },
            subtitle: {
                text: 'Custom animation of pie series',
                align: 'left'
            },
            tooltip: {
                pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
            },
            accessibility: {
                point: {
                    valueSuffix: '%'
                }
            },
            plotOptions: {
                pie: {
                    allowPointSelect: true,
                    borderWidth: 2,
                    cursor: 'pointer',
                    dataLabels: {
                        enabled: true,
                        format: '<b>{point.name}</b><br>{point.percentage}%',
                        distance: 20
                    }
                }
            },
            series: [{
                // Disable mouse tracking on load, enable after custom animation
                enableMouseTracking: false,
                animation: {
                    duration: 2000
                },
                colorByPoint: true,
                data: [{
                    name: 'Cần Thơ',
                    y: 20
                }, {
                    name: 'Tiền Giang',
                    y: 10
                }, {
                    name: 'Miền Đông',
                    y: 10
                }, {
                    name: 'Hồ Chí Minh',
                    y: 5
                }, {
                    name: 'Vũng Tàu',
                    y: 10
                }
                    , {
                    name: 'Nha Trang',
                    y: 10
                }, {
                    name: 'Đà Nẵng',
                    y: 5
                }, {
                    name: 'Nghệ An',
                    y: 15
                },
                {
                    name: 'Hà Nội',
                    y: 15
                }]
            }]
        });

    </script>
    <script>
        const colors = Highcharts.getOptions().colors.map((c, i) =>
            // Start out with a darkened base color (negative brighten), and end
            // up with a much brighter color
            Highcharts.color(Highcharts.getOptions().colors[0])
                .brighten((i - 3) / 7)
                .get()
        );

        // Build the chart
        Highcharts.chart('container-2', {
            chart: {
                plotBackgroundColor: null,
                plotBorderWidth: null,
                plotShadow: false,
                type: 'pie'
            },
            title: {
                text: 'Tỷ lệ doanh thu theo từng gam hàng',
                align: 'left'
            },
            tooltip: {
                pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
            },
            accessibility: {
                point: {
                    valueSuffix: '%'
                }
            },
            plotOptions: {
                pie: {
                    allowPointSelect: true,
                    cursor: 'pointer',
                    colors,
                    borderRadius: 5,
                    dataLabels: {
                        enabled: true,
                        format: '<b>{point.name}</b><br>{point.percentage:.1f} %',
                        distance: -50,
                        filter: {
                            property: 'percentage',
                            operator: '>',
                            value: 4
                        }
                    }
                }
            },
            series: [{
                name: 'Share',
                data: [
                    { name: 'OPC', y: 74.03 },
                    { name: 'Cồn', y: 12.66 },
                    { name: 'Sủi', y: 4.96 },
                    { name: 'Phiến', y: 2.49 },
                    { name: 'TW25', y: 2.31 },
                    { name: 'Other', y: 3.398 }
                ]
            }]
        });
    </script>
    <script>
        // Dữ liệu giả định
        var salesData = [@foreach (DataRow row3 in Model.Tables[5].Rows)
                                {
                                   @row3["DoanhThuThang01"].ToString().Replace(",", "")
                                },
                @foreach (DataRow row3 in Model.Tables[5].Rows)
                                {
                                   @row3["DoanhThuThang02"].ToString().Replace(",", "")
                                },
                @foreach (DataRow row3 in Model.Tables[5].Rows) {

                                   @row3["DoanhThuThang03"].ToString().Replace(",", "")
                                },
                @foreach (DataRow row3 in Model.Tables[5].Rows)
                                {
                                   @row3["DoanhThuThang04"].ToString().Replace(",", "")
                                },
                @foreach (DataRow row3 in Model.Tables[5].Rows)
                                {
                                   @row3["DoanhThuThang05"].ToString().Replace(",", "")
                                },
                @foreach (DataRow row3 in Model.Tables[5].Rows)
                                {
                                   @row3["DoanhThuThang06"].ToString().Replace(",", "")
                                },
                @foreach (DataRow row3 in Model.Tables[5].Rows)
                                {
                                   @row3["DoanhThuThang07"].ToString().Replace(",", "")
                                },
                @foreach (DataRow row3 in Model.Tables[5].Rows)
                                {
                                   @row3["DoanhThuThang08"].ToString().Replace(",", "")
                                },
                @foreach (DataRow row3 in Model.Tables[5].Rows)
                                {
                                   @row3["DoanhThuThang09"].ToString().Replace(",", "")
                                },
                @foreach (DataRow row3 in Model.Tables[5].Rows)
                                {
                                   @row3["DoanhThuThang10"].ToString().Replace(",", "")
                                },
                @foreach (DataRow row3 in Model.Tables[5].Rows)
                {
                                   @row3["DoanhThuThang11"].ToString().Replace(",", "")
                },

                @foreach (DataRow row3 in Model.Tables[5].Rows)
                                {
                    @row3["DoanhThuThang12"].ToString().Replace(",", "")
                                } ];
            var profitData = [@foreach (DataRow row3 in Model.Tables[4].Rows)
                                {
                                   @row3["DoanhThuThang01"].ToString().Replace(",", "")
                                },
                @foreach (DataRow row3 in Model.Tables[4].Rows)
                                {
                                   @row3["DoanhThuThang02"].ToString().Replace(",", "")
                                },
                @foreach (DataRow row3 in Model.Tables[4].Rows) {

                                   @row3["DoanhThuThang03"].ToString().Replace(",", "")
                                },
                @foreach (DataRow row3 in Model.Tables[4].Rows)
                                {
                                   @row3["DoanhThuThang04"].ToString().Replace(",", "")
                                },
                @foreach (DataRow row3 in Model.Tables[4].Rows)
                                {
                                   @row3["DoanhThuThang05"].ToString().Replace(",", "")
                                },
                @foreach (DataRow row3 in Model.Tables[4].Rows)
                                {
                                   @row3["DoanhThuThang06"].ToString().Replace(",", "")
                                },
                @foreach (DataRow row3 in Model.Tables[4].Rows)
                                {
                                   @row3["DoanhThuThang07"].ToString().Replace(",", "")
                                },
                @foreach (DataRow row3 in Model.Tables[4].Rows)
                                {
                                   @row3["DoanhThuThang08"].ToString().Replace(",", "")
                                },
                @foreach (DataRow row3 in Model.Tables[4].Rows)
                                {
                                   @row3["DoanhThuThang09"].ToString().Replace(",", "")
                                },
                @foreach (DataRow row3 in Model.Tables[4].Rows)
                                {
                                   @row3["DoanhThuThang10"].ToString().Replace(",", "")
                                },
                @foreach (DataRow row3 in Model.Tables[4].Rows)
                {
                                   @row3["DoanhThuThang11"].ToString().Replace(",", "")
                },

                @foreach (DataRow row3 in Model.Tables[4].Rows)
                                {
                    @row3["DoanhThuThang12"].ToString().Replace(",", "")
                                } ];

        // Tạo biểu đồ kết hợp
        Highcharts.chart('combinedChartContainer', {
            title: {
                text: 'Doanh thu so với Cùng kỳ'
            },
            xAxis: {
                categories: ['Tháng 1', 'Tháng 2', 'Tháng 3', 'Tháng 4', 'Tháng 5', 'Tháng 6', 'Tháng 7', 'Tháng 8', 'Tháng 9', 'Tháng 10', 'Tháng 11', 'Tháng 12']
            },
            yAxis: {
                title: {
                    text: 'Giá Trị',
                    style: {
                        color: Highcharts.getOptions().colors[1]
                    }
                },
                labels: {
                    formatter: function () {
                        return (this.value / 1000000000) + ' M';
                    },
                    style: {
                        color: Highcharts.getOptions().colors[1]
                    }
                }
            },
            series: [
                {
                    name: 'Doanh Thu',
                    type: 'column',
                    data: profitData,
                    tooltip: {
                        valueSuffix: ' M'
                    }
                },
                {
                    name: 'Cùng Kỳ',
                    type: 'line',
                    data: salesData,
                    tooltip: {
                        valueSuffix: ' M'
                    }
                }
            ]
        });
    </script>
    <script>
        // Dữ liệu giả định: tỷ lệ 70%
        var data = [
            ['70%', 70],
            ['30%', 30]
        ];

        // Tạo biểu đồ hình tròn
        Highcharts.chart('smallPieChartContainer', {
            chart: {
                type: 'pie',
                plotBackgroundColor: null,
                plotBorderWidth: 0,
                plotShadow: false
            },
            title: {
                text: null
            },
            tooltip: {
                pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
            },
            accessibility: {
                point: {
                    valueSuffix: '%'
                }
            },
            plotOptions: {
                pie: {
                    dataLabels: {
                        enabled: true,
                        format: '{point.name}: {point.percentage:.1f} %'
                    },
                    startAngle: -90,
                    endAngle: 90,
                    center: ['50%', '75%'],
                    size: '110%'
                }
            },
            series: [{
                type: 'pie',
                name: 'Percentage',
                innerSize: '50%',
                data: data
            }]
        });
    </script>
    <script>
    function formatNumberWithUnit(value) {
        if (value >= 1000000000) {
            return Math.round(value / 1000000000) + " Tỷ";
        } else if (value >= 1000000) {
            return Math.round(value / 1000000) + " Triệu";
        } else {
            return value.toString();
        }
    }
        @*var arr = @foreach (DataRow row3 in Model.Tables[1].Rows)
                            {
                               @Math.Round(Double.Parse(row3["Tong_Doanh_Thu_Thang"].ToString().Replace(",", "")))
                };*@
    var data = {
        labels: ['Đạt được', 'Còn lại'],
        datasets: [{
            data: [@foreach (DataRow row3 in Model.Tables[1].Rows)
                            {
                               @Math.Round(Double.Parse(row3["Tong_Doanh_Thu_Thang"].ToString().Replace(",", "")))
                },  @(Math.Round(Convert.ToDouble(KhoanThang), MidpointRounding.AwayFromZero))
            ], // Sử dụng giá trị đã chuyển đổi
            backgroundColor: ['#2992a7', '#e0e0e0']
        }]
    };
    var total = data.datasets[0].data.reduce((a, b) => a + b, 0);
    var remainingValue = data.datasets[0].data[0];
    var ConLai = @KhoanThang - remainingValue;
    // Tính phần trăm cho mỗi giá trị trong mảng dữ liệu
    var percentages = ((remainingValue / @KhoanThang) * 100).toFixed(2);
        var percentages2 = 100 - percentages;
        console.log("Khoan thang", percentages2);
    // Thêm phần trăm vào nhãn
    var labels = [
        "Đạt được: " + formatNumberWithUnit(Math.round(data.datasets[0].data[0])) + " (" + percentages + "%)",
        "Còn lại: " + formatNumberWithUnit(ConLai) + " (" + percentages2.toFixed(2) + "%)"
    ];
    // Lấy thẻ canvas và vẽ biểu đồ
    var ctx = document.getElementById('myPieChart2').getContext('2d');
        var myPieChart = new Chart(ctx, {
            type: 'pie',
            data: {
                labels: labels,
                datasets: data.datasets
            },
            options: {
                plugins: {
                    tooltip: {
                        enabled: false, // Disable tooltips
                    }
                }
            }
        });



    </script>
    <script>
    function formatNumberWithUnit(value) {
        if (value >= 1000000000) {
            return Math.round(value / 1000000000) + " Tỷ";
        } else if (value >= 1000000) {
            return Math.round(value / 1000000) + " Triệu";
        } else {
            return value.toString();
        }
    }

    var data = {
        labels: ['Đạt được', 'Còn lại'],
        datasets: [{
            data: [@foreach (DataRow row3 in Model.Tables[0].Rows)
                            {
                               @Math.Round(Double.Parse(row3["Tong_Doanh_Thu_Nam"].ToString().Replace(",", "")))
                },  @(Math.Round(Convert.ToDouble(KhoanNam), MidpointRounding.AwayFromZero))
            ], // Sử dụng giá trị đã chuyển đổi
            backgroundColor: ['#ff9100', '#e0e0e0']
        }]
    };
    var total = data.datasets[0].data.reduce((a, b) => a + b, 0);
    var remainingValue = data.datasets[0].data[0];
    var ConLai = @KhoanNam - remainingValue;
    // Tính phần trăm cho mỗi giá trị trong mảng dữ liệu
    var percentages = ((remainingValue / @KhoanNam) * 100).toFixed(2);
    var percentages2 = 100 - percentages;
    // Thêm phần trăm vào nhãn
    var labels = [
        "Đạt được: " + formatNumberWithUnit(Math.round(data.datasets[0].data[0])) + " (" + percentages + "%)",
        "Còn lại: " + formatNumberWithUnit(ConLai) + " (" + percentages2.toFixed(2) + "%)"
    ];
    // Lấy thẻ canvas và vẽ biểu đồ
    var ctx = document.getElementById('myPieChart').getContext('2d');
        var myPieChart = new Chart(ctx, {
            type: 'pie',
            data: {
                labels: labels,
                datasets: data.datasets
            },
            options: {
                plugins: {
                    tooltip: {
                        enabled: false, // Disable tooltips
                    }
                }
            }
        });



    </script>








    <script>
        // Tạo dữ liệu cho biểu đồ
            var data = {
                labels: ['Đạt được', 'Còn lại'],
            datasets: [{
                data: [@foreach (DataRow row3 in Model.Tables[0].Rows)
                                {
                                   @row3["Tong_Doanh_Thu_Nam"].ToString().Replace(",", "")
                                }, 19448000000

], // Sử dụng giá trị đã chuyển đổi
                backgroundColor: ['#19cf16', '#e0e0e0']
            }]
        };
            var total = data.datasets[0].data.reduce((a, b) => a + b, 0);

            // Tính phần trăm cho mỗi giá trị trong mảng dữ liệu
            var percentages = data.datasets[0].data.map(value => ((value / total) * 100).toFixed(2));

            // Thêm phần trăm vào nhãn
            var labels = data.labels.map((label, index) => label + " - " + percentages[index] + "%");

        // Lấy thẻ canvas và vẽ biểu đồ
        var ctx = document.getElementById('myPieChart4').getContext('2d');
        var myPieChart = new Chart(ctx, {
            type: 'pie',
            data: {
                labels: labels,
                datasets: data.datasets
            },
            options: {
                title: {
                    display: true,
                    text: 'Tỷ lệ %'
                },
                legend: {
                    display: true  // Ẩn chú thích
                },
                plugins: {
                    labels: {
                        render: 'percentage',
                        fontColor: ['black', 'black'], // Màu chữ của phần trăm cho mỗi phần
                        precision: 2
                    }
                }
            }
        });
    </script>
    <script>
        // Tạo dữ liệu cho biểu đồ
        var data = {
            labels: ['Đạt được', 'Còn lại'],
            datasets: [{
                data: [@foreach (DataRow row3 in Model.Tables[0].Rows)
                                {
                                   @row3["Tong_Doanh_Thu_Nam"].ToString().Replace(",", "")
                                }, 65860000000

], // Sử dụng giá trị đã chuyển đổi
                backgroundColor: ['#0097ff', '#e0e0e0']
            }]
        };
            var total = data.datasets[0].data.reduce((a, b) => a + b, 0);

            // Tính phần trăm cho mỗi giá trị trong mảng dữ liệu
            var percentages = data.datasets[0].data.map(value => ((value / total) * 100).toFixed(2));

            // Thêm phần trăm vào nhãn
            var labels = data.labels.map((label, index) => label + " - " + percentages[index] + "%");

        // Lấy thẻ canvas và vẽ biểu đồ
        var ctx = document.getElementById('myPieChart3').getContext('2d');
        var myPieChart = new Chart(ctx, {
            type: 'pie',
            data: {
                labels: labels,
                datasets: data.datasets
            },
            options: {
                title: {
                    display: true,
                    text: 'Tỷ lệ %'
                },
                legend: {
                    display: true  // Ẩn chú thích
                },
                plugins: {
                    labels: {
                        render: 'percentage',
                        fontColor: ['black', 'black'], // Màu chữ của phần trăm cho mỗi phần
                        precision: 2
                    }
                }
            }
        });
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Dữ liệu cho biểu đồ
            var data = [
                { category: 'Tháng 1', value1: 3, value2: 3 },
                { category: 'Tháng 2', value1: 8, value2: 4 },
                { category: 'Tháng 3', value1: 2, value2: 5 },
                { category: 'Tháng 4', value1: 6, value2: 6 },
                { category: 'Tháng 5', value1: 4, value2: 7 },
                { category: 'Tháng 6', value1: 7, value2: 8 },
                { category: 'Tháng 7', value1: 1, value2: 9 },
                { category: 'Tháng 8', value1: 9, value2: 10 },
                { category: 'Tháng 9', value1: 5, value2: 11 },
                { category: 'Tháng 10', value1: 3, value2: 12 },
                { category: 'Tháng 11', value1: 8, value2: 13 },
                { category: 'Tháng 12', value1: 2, value2: 14 }
            ];

            // Chuyển đổi dữ liệu để phù hợp với định dạng của Highcharts
            var seriesData = [
                { name: 'Doanh Thu', data: [] },
                { name: 'Lũy Kế', data: [] }
            ];

            data.forEach(function (item) {
                seriesData[0].data.push(item.value1);
                seriesData[1].data.push(item.value2);
            });

            // Tạo biểu đồ cột
            Highcharts.chart('container3', {
                chart: {
                    type: 'column'
                },
                title: {
                    text: 'Doanh thu và Lũy kế'
                },
                xAxis: {
                    categories: data.map(function (item) {
                        return item.category;
                    })
                },
                yAxis: {
                    title: {
                        text: 'Giá trị'
                    }
                },
                series: seriesData
            });
        });
    </script>
</body>
</html>
